<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
		<title>Wishlist | Paly Robotics</title>

		<!-- Bootstrap -->
		<link href="/assets/css/bootstrap.min.css" rel="stylesheet">
		<link href="/assets/css/stylesheet.css" rel="stylesheet">


		<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
	      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
	      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	    <![endif]-->
		<link href="https://fonts.googleapis.com/css?family=Righteous|Poppins" rel="stylesheet">

		<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">

	</head>


<body>
	<div id="top-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
		<div class="container naver">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle menu-button" data-toggle="collapse" data-target=".navbar-collapse">
		   			<span class="sr-only">Toggle navigation</span>
		   			<span class="icon-bar"></span>
		   			<span class="icon-bar"></span>
		   			<span class="icon-bar"></span>
   				</button>

				<a class="navbar-brand" href="index.html">
					<span><img id="logo" src="https://avatars3.githubusercontent.com/u/1227303?v=3&s=280"></span><span><h1>Paly Robotics</h1></span></a>
			</div>
			<div class="navbar-collapse collapse">
				<ul class="nav navbar-nav navbar-right ">
					<li class="links"><a class="links" href="index.html#Home">Home</a></li>
					<li class="links"><a class="links" href="index.html#AboutUs">About Us</a></li>
					<li class="links"><a class="links" href="index.html#Subteams">Subteams</a></li>
					<li class="links"><a class="links" href="index.html#Sponsors">Sponsors</a></li>
					<li class="dropdown links">
						<a ref="#" class="dropdown-toggle links" data-toggle="dropdown">More<b class="caret"></b></a>
						<ul class="dropdown-menu">
							<li><a class="dropdown-text" href="calendar.html">Calendar</a></li>
							<li><a class="dropdown-text" href="resources.html">Resources</a></li>
							<li><a class="dropdown-text" href="art.html">Art</a></li>
							<li><a class="dropdown-text" href="zero-robotics.html">Zero</a></li>
							<li><a class="dropdown-text" href="wishlist.html">Wishlist</a></li>
							<li><a class="dropdown-text" href="summer-camp.html">Summer Camp</a></li>
						</ul>
					</li>
					<li class="links"><a class="links" href="ContactUs-page.html">Contact</a></li>
				</ul>
			</div>
		</div>
	</div>

  <div class="container first-container">
    <div class="col-md-12">
      <h2>Wishlist</h2>
    </div>
  </div>

  <div class="container">
    <hr>
    <p id="tobegin">Below is the list if items we need for our lab. If you are willing to buy/donate any of these items, please talk to our lab manager Shota. You can find Shota's contact information on the "Leads" page under "More".</p>
    <ul class="pagination" id="pRangeButtons">
      <li id="1,1000000" class="active"><a href="#" onclick="paginationClicked([1.00,1000000.0])">All</a></li>
      <li id="1,20"><a href="#" onclick="paginationClicked([1.0,20.0])">$0-$20</a></li>
      <li id="20,50"><a href="#" onclick="paginationClicked([20.0,50.0])">$20-$50</a></li>
      <li id="50,100"><a href="#" onclick="paginationClicked([50.0,100.0])">$50-$100</a></li>
      <li id="100,300"><a href="#" onclick="paginationClicked([100.0,300.0])">$100-$300</a></li>
      <li id="300,1000000"><a href="#" onclick="paginationClicked([300.0,1000000.0])">$300+</a></li>
    </ul>
      
    <table class="table table-bordered">
      <thead>
        <tr id="toshow">
        </tr>
      </thead>
      <tbody id="csv-import">
      </tbody>
    </table>
  </div>

  <div style="display: none">
    <div id="authorize-div" style="display: none">
  	<span>Authorize access to Google Sheets API</span>
      <!--Button for the user to click to initiate auth sequence -->
      <button id="authorize-button" onclick="handleAuthClick(event)">
        Authorize
      </button>
    </div>
<!--   	<pre id="output"></pre> -->
  </div>

  

  </body>

    <style>
        div.first-container {
            padding-top:150px;
            font-family:'Poppins',sans-serif;
        }
        h2{
            font-family:'Poppins',sans-serif;
            text-align:center;
            font-size:45px;
        }
        hr {
            margin-bottom:40px !important;
        }
        body{
          font-family:'Poppins',sans-serif;
        }
        p{
          font-size: 15px;
        }
        

    </style>

    <script>

    	var currentSelection = "1,1000000";
      var items = [];
      // Your Client ID can be retrieved from your project in the Google
      // Developer Console, https://console.developers.google.com
      var CLIENT_ID = '68198727240-hm6g70hsqk4vr28i3pan3kot586ftl39.apps.googleusercontent.com';

      var SCOPES = ["https://www.googleapis.com/auth/spreadsheets.readonly"];

      /**
       * Check if current user has authorized this application.
       */
      function checkAuth() {
        gapi.auth.authorize(
          {
            'client_id': CLIENT_ID,
            'scope': SCOPES.join(' '),
            'immediate': true
          }, handleAuthResult);
      }

      /**
       * Handle response from authorization server.
       *
       * @param {Object} authResult Authorization result.
       */
      function handleAuthResult(authResult) {
        var authorizeDiv = document.getElementById('authorize-div');
        if (authResult && !authResult.error) {
          // Hide auth UI, then load client library.
          authorizeDiv.style.display = 'none';
          loadSheetsApi();
        } else {
          // Show auth UI, allowing the user to initiate authorization by
          // clicking authorize button.
          authorizeDiv.style.display = 'inline';
        }
      }

      /**
       * Initiate auth flow in response to user clicking authorize button.
       *
       * @param {Event} event Button click event.
       */
      function handleAuthClick(event) {
        gapi.auth.authorize(
          {client_id: CLIENT_ID, scope: SCOPES, immediate: false},
          handleAuthResult);
        return false;
      }

      /**
       * Load Sheets API client library.
       */
      function loadSheetsApi() {
        var discoveryUrl =
            'https://sheets.googleapis.com/$discovery/rest?version=v4';
        gapi.client.load(discoveryUrl).then(listMajors);
      }

      /**
       * Print the names and majors of students in a sample spreadsheet:
       * https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit
       */
      function listMajors() {
        gapi.client.sheets.spreadsheets.values.get({
          spreadsheetId: '1vWUMlrsi68jPKpUP1JCNLtbMooPm17zXeZaMf9Dw1SY',
          range: 'A2:E',
        }).then(function(response) {
          items = response.result.values;
          sortValues();
        }, function(response) {
          appendPre('Error: ' + response.result.error.message);
        });
      }

      /**
       * Append a pre element to the body containing the given message
       * as its text node.
       *
       * @param {string} message Text to be placed in pre element.
       */
      function appendPre(message) {
        var pre = document.getElementById('output');
        var textContent = document.createTextNode(message + '\n');
        pre.appendChild(textContent);
      }

      function sortValues(){
      	document.getElementById("toshow").innerHTML = "<th class=\"col-md-5\">Item Name</th><th class=\"col-md-3\">Online Vendor</th><th class=\"col-md-1\">Quantity</th><th class=\"col-md-3\">Total Price</th>";
      	items = items.sort(function(a, b){
      		var firstPriceString = a[4];
			firstPriceString = firstPriceString.substr(1);
			firstPriceString = firstPriceString.replace(/,/g , "");
			var firstPrice = parseFloat(firstPriceString);

			var secondPriceString = b[4];
			secondPriceString = secondPriceString.substr(1);
			secondPriceString = secondPriceString.replace(/,/g , "");
			var secondPrice = parseFloat(secondPriceString);



      		return firstPrice-secondPrice
      	})
      	console.log("sortvalues",items);
      	createTable();
      }
      function createTable(){
      	var innerHTML = "";
      	for (var i = 0; i < items.length; i++){
      		innerHTML += "<tr>"
          	innerHTML += "<td>" + items[i][0] + "</td>"
          	innerHTML += "<td><a target=\"_blank\" href=\"" + items[i][1] + "\">" + items[i][2] + "</a></td>"
          	innerHTML += "<td>" + items[i][3] + "</td>"
          	innerHTML += "<td>" + items[i][4] + "</td></tr>"
      	}
      	document.getElementById("csv-import").innerHTML = innerHTML;

      }

        	  //Runs when a pagination button is clicked.  
      function paginationClicked(priceRange){
      	console.log("pressed");
      	//Finds the pagination that was clicked earlier and deletes the "active" class from it
      	document.getElementById(currentSelection).className = document.getElementById(currentSelection).className.replace( /(?:^|\s)active(?!\S)/g , '' )
      	
        var minPrice = priceRange[0];
        var maxPrice = priceRange[1];

        //Sets currentSelection to the button currently selected and updates the pagination
        currentSelection = minPrice.toString() + "," + maxPrice.toString();
        document.getElementById(currentSelection).className += "active";

        //The table is ordered price wise, from lowest to higest. minIndex finds the lowest index of the price range in the table.
        var minIndex = 0;

        //i for while loop
        var i = 0;

        //If minPrice is already 0, we don't want to waste time looping through. Otherwise, we continue...
        if (minPrice != 0){
          //While is more efficent here because minIndex will most likely be before the end of the loop.
          while (minIndex == 0){

          	//Converting the currentPrice
            var currentPriceString = items[i][4];
			currentPriceString = currentPriceString.substr(1);
			currentPriceString = currentPriceString.replace(/,/g , "");
			var currentPrice = parseFloat(currentPriceString);

         
            if (priceRange[0] < currentPrice){
              minIndex = i;
            }

            i++
          }
        }else{
          minIndex = 0;
        }
        if (maxPrice == 1000000.0){
          maxIndex = items.length;

        }else{
       		//Same as above
        	var maxIndex = 0;
        	var i = 0;

        	while (maxIndex == 0 && i < items.length){
          
            	//Converting the currentPrice
            	var currentPriceString = items[i][4];
				currentPriceString = currentPriceString.substr(1);
				currentPriceString = currentPriceString.replace(/,/g , "");
				var currentPrice = parseFloat(currentPriceString);

          		if (priceRange[1] < currentPrice){
            		maxIndex = i;
          		}
          		i++

        	}
        }

        //If they could not find a max index, it means that it is a miilion or higher, so we set it to the highest index


        var innerHTML = "";
      	for (var i = minIndex; i < maxIndex; i++){
      		innerHTML += "<tr>"
          	innerHTML += "<td>" + items[i][0] + "</td>"
          	innerHTML += "<td><a target=\"_blank\" href=\"" + items[i][1] + "\">" + items[i][2] + "</a></td>"
          	innerHTML += "<td>" + items[i][3] + "</td>"
          	innerHTML += "<td>" + items[i][4] + "</td></tr>"
      	}
      	document.getElementById("csv-import").innerHTML = innerHTML;


        
      }
    </script>
    <script src="https://apis.google.com/js/client.js?onload=checkAuth"></script>

	<div class="navbar navbar-inverse navbar-static-bottom nav-bot" role="navigation">
		<div class="container foot">
			<div class="navbar-text pull-left">
				<p class="footer">© Paly Robotics 2016</p>
			</div>
			<div class="navbar-text pull-right icons">
				<a href="https://www.facebook.com/PalyRobotics/" target="_blank"><i class="fa fa-facebook-square fa-2x facebook"></i></a>
				<a href="https://twitter.com/frc8?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor" target="_blank"><i class="fa fa-twitter fa-2x twitter twitter"></i></a>
				<a href="https://www.youtube.com/channel/UCxDYmpiPO5we91MfFKfWzsQ" target="_blank"><i class="fa fa-youtube-play fa-2x youtube"></i></a>
			</div>
		</div>
	</div>
</body>

<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
	<!-- Include all compiled plugins (below), or include individual files as needed -->
	<script src="assets/js/bootstrap.min.js"></script>

</html>